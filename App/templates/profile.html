<!-- temporary file -->
{% extends "layout.html" %}
{% block title %}Login{% endblock %}
{% block page %}{{profile.shopName}}{% endblock %}

{{ super() }}

{% block content %}
<div class="container section" style="display:grid; min-width: 100%;">
  <div class="row center" style="height:300px;">
  <div >
    <div class = "white-text"><img class="responsive-img circle" src="/{{profile.profilePic}}"></div>
  </div>
  
  <div class="divider"></div>

  <div class="row center">
    <div class="col s6 white-text">username:</div>
    <div class = "col s6 white-text">{{profile.username}}</div>
  </div>

  <div class="row center">
    <div class="col s6 white-text">shopname:</div>
    <div class = "col s6 white-text">{{profile.shopName}}</div>
  </div>
  
  {% if current_user.is_authenticated and current_user.id == profile.id %}
  <div class="row center">
    <a class="col s12 white-text" href="/edit"><i class="material-icons">edit</i></a>
  </div>
  </div>
  <div class="divider"></div>
  <span class="row white-text">Your Listings</span>
  <div class="row center">
    <a class="col s12 white-text" href="/listing"><i class="material-icons">add</i></a>
  </div>
  {% endif %}
</div>

<!-- <div style = "height:100vh; ">
  <div >
    <a href="/listing">
      <button class = "black-text">CREATE LISTING</button>
    </a>
  </div> -->
  
  
  <div class="index-banner color2 " >
    <div class="row" style="margin-top: 70px;">

      <div class="col s10 offset-s1">
        {% for ele in data %}
          <!-- <a class = "card mall" href="../listing/{{ele.listing['id']}}">{{ele.listing['name']}}</a> -->
            <!-- <div class="row"> -->
              <div class="col s12">
                <div class="card blue-grey darken-1 truncate hoverable">
                  <a href="../listing/{{ele.listing['id']}}">{{ele.listing['html']|safe}}</a>
                  <div class="card-action">
                    <a href="../listing/{{ele.listing['id']}}">{{ele.listing['name']}}</a>
                    <a href="../profile?id={{ele.farmer['id']}}">{{ele.farmer['shopName']}}</a>
                    {% if current_user.is_authenticated and current_user.id == profile.id %}
                    <button class="btn-floating waves-effect waves-light red right" onclick="deleteListing(`{{ele.listing['id']}}`)">
                      <i class="material-icons">delete</i>
                    </button>
                    {% endif %}
                  </div>
                </div>
              </div>
            <!-- </div> -->
          </a>
        {% endfor %}
                    <script>
                      function deleteListing(id) {
                        if (!id) return
                          fetch("../listing/"+id, {
                            method: 'DELETE'
                          })
                          .then((r) => {
                            document.location.reload()
                          })
                      }
                    </script>
      </div>
    </div>
</div>
</div>
  
{% endblock %}




