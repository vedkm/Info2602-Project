<!-- temporary file -->
{% extends "layout.html" %}
{% block title %}Profile{% endblock %}
{% block page %}{{profile.shopName}}{% endblock %}

{{ super() }}

{% block content %}
<div class="container section1" style=" display:grid; min-width: 100%;">
  <div class="section" style="background:linear-gradient(180deg,#ffd54f  ,#e65100); width: 100%;">
    <div class="row center" style="height:300px; width: 25%;">
    <div >
      <div class = "white-text"><img class="responsive-img circle" src="/{{profile.profilePic}}"></div>
    </div>
    
    <div class="divider"></div>

    <div class="row center">
      <div class="col s6 white-text"><b>username</b>:</div>
      <div class = "col s6 white-text"><b>{{profile.username}}</b></div>
    </div>

    <div class="row center">
      <div class="col s6 white-text"><b>shopname</b>:</div>
      <div class = "col s6 white-text"><b>{{profile.shopName}}</b></div>
    </div>

    <div class="row center">
      <div class="col s6 white-text"><b>contact</b>:</div>
      <div class = "col s6 white-text"><b>{{profile.contact}}</b></div>
    </div>

    <div class="row center">
      <div class="col s6 white-text"><b>location</b>:</div>
      <div class = "col s6 white-text"><b>{{profile.location}}</b></div>
    </div>
    
    {% if current_user.is_authenticated and current_user.id == profile.id %}
    <div class="row center">
      <a class="col s12 white-text" href="/edit"><i class="material-icons"> edit</i></a>
    </div>
    </div>
  </div>
  <div class="divider"></div>
  <span  class="row white-text"> <p style="font-size:40px; font-style: oblique;"> Your Listings </p> </span>
  <div class="row center">
    <a class="col s12 white-text" href="/listing"><i class="material-icons">add</i></a>
  </div>
  {% endif %}
</div>

<!-- <div style = "height:100vh; ">
  <div >
    <a href="/listing">
      <button class = "black-text">CREATE LISTING</button>
    </a>
  </div> -->
  
  
  <div class="index-banner color2 " >
    <div class="container" style="margin-top: 70px;">

      <div class="row">
        {% for ele in data %}
          <!-- <a class = "card mall" href="../listing/{{ele.listing['id']}}">{{ele.listing['name']}}</a> -->
            <div class="row">
              <div class="row" style="max-width: 100vw;">
                <div class="card orange darken-4  darken-1 truncate hoverable">
                  {{ele.listing['html']|safe}}
                  <div class="card-action black row">
                    <div class="col s11">
                      <a href="../listing/{{ele.listing['id']}}">{{ele.listing['name']}}</a>
                      <a href="../profile?id={{ele.farmer['id']}}">{{ele.farmer['shopName']}}</a>
                    </div>
                    {% if current_user.is_authenticated and current_user.id == profile.id %}
                    <div class="col s1">
                      <a href="../listing/{{ele.listing['id']}}" class="btn-floating waves-effect waves-light red">
                        <i class="material-icons">edit</i>
                      </a>
                      <button class="btn-floating waves-effect waves-light red" onclick="deleteListing(`{{ele.listing['id']}}`)">
                        <i class="material-icons">delete</i>
                      </button>
                    </div>
                    {% endif %}
                  </div>
                </div>
              </div>
            <!-- </div> -->
          </a>
        {% endfor %}
                    <script>
                      function deleteListing(id) {
                        if (!id) return
                          fetch("../listing/"+id, {
                            method: 'DELETE'
                          })
                          .then((r) => {
                            document.location.reload()
                          })
                      }
                    </script>
      </div>
    </div>
</div>
</div>
  
{% endblock %}




